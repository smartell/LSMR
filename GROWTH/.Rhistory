for(i in 1:I)
{
tmp_m=(seq(1,length(i:J),1)-1)*m
tmp_f=c(0,cumsum(fj[i:(J-1)]))
Z[i,i:J]=tmp_m + tmp_f
p=exp(-Z[i,i:J])*cj[i:J]
R[i,i:J]=rmultinom(1,ni[i],p)
}
print(cbind(ni,R))
## End of data generation.
## PARAMETER_SECTION
theta = list(log.m=log(0.5),log.fj=log(fj))# rep(0.1,length=J))
itheta = as.relistable(theta)
## PROCEDURE_SECTION
brownie <- function(theta)
{
with(relist(theta,skeleton=itheta),{
m=exp(log.m)
fj=exp(log.fj)
#compute predicted recaptures given ni
P=Z=F=Rhat=matrix(nrow=I,ncol=J)
cj = fj/(m+fj)*(1-exp(-m-fj))
nll = 0
for(i in 1:I)
{
tmp_m=(seq(1,length(i:J),1)-1)*m
tmp_f=c(0,cumsum(fj[i:(J-1)]))
Z[i,i:J]=tmp_m + tmp_f
p=exp(-Z[i,i:J])*cj[i:J]
Rhat[i,i:J]=ni[i]*p#rmultinom(1,ni[i],p)
#nll=nll   +sum(-dpois(R[i,i:J],Rhat[i,i:J],log=TRUE))
nll=nll+sum(-dmultinom(R[i,i:J],prob=p,log=TRUE))
}
return(nll)
})
}
## Solver routine to estimate parameters.
solver<-function(theta,objfun,hess=FALSE)
{
fit<-optim(theta,objfun,method="BFGS",hessian=hess)
if(hess==TRUE)
{
H=fit$hessian     #Matrix of 2nd derivatives
V=solve(H)        #Variance covariance matrix
std=sqrt(diag(V))  #Std of parameters
R=V/(std %o% std) #Correlations.
fit$R=R; fit$std=std
}
return(fit)
}
fit <- solver(unlist(itheta),brownie,TRUE)
print(exp(fit$par))
source('~/Documents/UBC_Courses/Fish_504/ASSIGNMENTS/FISHGROWTH/GrowthSim.R')
source('~/Documents/UBC_Courses/Fish_504/ASSIGNMENTS/FISHGROWTH/vonB.R')
dir()
source('~/Documents/UBC_Courses/Fish_504/ASSIGNMENTS/FISHGROWTH/vonB.R')
fit$par
ls
ls()
gdata
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("BC.GI.data.txt", header=T)#
#
#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
B=read.admb("HillaryGrowth")
require(MCMCpack)
plot(mcmc(B$post.samp))
plot(mcmc(exp(B$post.samp)))
A
B$epsilon
qqnorm(B$epsilon)
plot(B$epsilon)
plot(B$epsilon,type="h")
qqnorm(B$epsilon)
qqline(B$epsilon)
A=read.admb("HillaryGrowth")
qqline(A$epsilon)
qqnorm(B$epsilon,add=T,col=2)
qqpoints(A$epsilon)
??qqnorm
A=read.admb("HillaryGrowth")
pairs(A$post.samp)
pairs(exp(A$post.samp))
plot(mcmc(exp(A$post.samp)))
dt( -14.9858,0.27711)
dt( -14.9858,0.27711,log=T)
gdata
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("BC.GI.data.txt", header=T)#
#
#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
gdata
df
?df
g
g = 1/(1/100+gdata[,1]/79)
plot(g)
g = 1/(1/10+gdata[,1]/79)
plot(g)
g = 1/(1/500+gdata[,1]/79)
plot(g)
g = 1/(1/500+gdata[,1]/20)
plot(g)
g = 1/(1/500+gdata[,1]/200)
plot(g)
A=read.admb("HillaryGrowth")
plot(exp(A$post.samp))
plot(mcmc(exp(A$post.samp)))
mean(A$post.samp)
colMeans(A$post.samp)
colMeans(exp(A$post.samp))
exp(colMeans(A$post.samp))
g = (1/500+gdata[,1]/200)
plot(g)
g = (1/100+gdata[,1]/200)
plot(g)
1/100
1/100/1
1/1/100
1/(1/100)
1/(1/100+1)
mean(gdata[,1])
l=mean(gdata[,1])
phi=82
1/(1/100+l/phi)
1/(1/1+l/phi)
1/(1/1000000000+l/phi)
B=read.admb("HillaryGrowth")
plot(mcmc(exp(B$post.samp)))
B=read.admb("HillaryGrowth")
plot(mcmc(exp(B$post.samp)))
summary(B$post.samp)
summary(exp(B$post.samp)_
summary(exp(B$post.samp))
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=".", xlab="Length at release", ylab="Relative growth increment")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlab=c(0, 500))#
abline(h=0)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlab=c(0, 500))#
abline(h=0)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
B=read.admb("hillarygrowth")
B
names(B)
points(B$ltag,dl_hat/gdata[,3])
points(B$ltag,B$dl_hat/gdata[,3],col=3)
points(B$ltag,B$dl_hat/gdata[,3]+B$epsilon,col=3)
points(B$ltag,B$dl_hat,col=3)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat,col=3)
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat,cex=0.25,col=3)
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat/gdata[,3],cex=0.25,col=3)
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=T)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat/gdata[,3],cex=0.25,col=3)
length(gdata[,3])
length(B$dl_hat)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat/gdata[,3],cex=0.25,col=3)
points(B$ltag,B$dl_hat/gdata[,3]+B$epsilon,cex=0.25,col=3)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat/gdata[,3]+B$epsilon,cex=0.25,col=3)
points(B$ltag,B$dl_hat/gdata[,3]-B$epsilon,cex=0.25,col=3)
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat/gdata[,3]-B$epsilon,cex=0.25,col=3)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
points(B$ltag,B$dl_hat+B$epsilon,cex=0.25,col=3)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
#
plot(gdata[, 1], gdata[, 2]/gdata[,3], pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag, A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = 399.004; k=0.155482#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,A$dl_hat+epsilon, pch=1, cex=0.25, col=3)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,A$dl_hat+A$epsilon, pch=1, cex=0.25, col=3)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
A$lhat
A$ltag
names(A)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,A$dl_hat/A$dt+A$epsilon, pch=1, cex=0.25, col=3)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
?loess
lines(A$ltag,loess(A$epsilon))
lines(A$ltag,loess(A$epsilon~A$ltag))
loess(A$epsilon~A$ltag)
lines(A$ltag,lowess(A$epsilon))
lines(A$ltag,lowess(A$ltag,A$epsilon))
plot(A$epsilon)
lines(lowess(A$epsilon))
lines(lowess(A$epsilon),lwd=5,col=2)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
linf = 390.878; k=0.183129#
lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
Estimation
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
Estimation
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
sum(A$epsilon)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
sum(A$epsilon)
mean(A$epsilon)
dim(gdata)
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
exp(-1.95986846143)
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
pairs(exp(A$post.samp))
setwd('/Users/stevenmartell/Documents/CONSULTING/HumpbackChub/HBC_2011_Assessment/GROWTH')
## Estimation of growth parameters for HBC using Hillary,  2011 paper.#
source("../R/read.admb.R")#
gdata <- read.table("HBC.GI.data.txt", header=F)#
A <- read.admb("HillaryGrowth")#
#
plot(A$ltag,A$dl/A$dt, pch=20, cex=0.5, xlab="Length at release", ylab="Relative growth increment", xlim=c(0, 500))#
abline(h=0)#
#
x=seq(0, 500, by=10)#
#linf = 390.878; k=0.183129#
#lines(x, (linf-x)*(1-exp(-k)), col=2)#
linf = A$linf; k=A$k#
lines(x, (linf-x)*(1-exp(-k)), col=4)#
#
points(A$ltag,(A$dl_hat+A$epsilon)/A$dt, pch=1, cex=0.25, col=3)#
#
plot(A$ltag,A$epsilon, type="h")#
#
## Extract the HBC data from the large CSV file.#
get.HBC.data<-function()#
{#
HBC <- read.csv(file = "GCMRC_ASMR_TAG_HISTORY_ALL.csv", header = TRUE, stringsAsFactors = FALSE)#
#
## Reformat the date column#
dates <- as.POSIXct(strptime(as.character(HBC$DATES), "%m/%d/%Y"))#
HBC$DATES <- dates#
#
id <- unique(HBC$TAGNO)#
#
growth.increment <- function(tag.no)#
{#
	df <- subset(HBC, TAGNO==tag.no)#
	if(dim(df)[1]==1) return(NULL)#
	df <- df[order(df$DATE), ]#
#
	n <- dim(df)[1]#
	dt <- as.numeric(diff(c(df$DATE[1],df$DATE[n])))/365.25#
	if(dt<=0.5) return(NULL)#
	dl <- df$TL[n] - df$TL[1]#
	return(c(df$TL[1], dl, dt))#
}#
#
dlist <- sapply(id, growth.increment)#
gdata <- matrix(unlist(dlist),ncol=3,byrow=T)#
plot(gdata[,1],gdata[,2]/gdata[,3], pch=".")#
abline(h=0)#
write.table(gdata,file="HBC.GI.data.txt",row.names=F,col.names=c("RL","dl","dt"))#
}
pairs(exp(A$post.samp))
pairs(exp(A$post.samp[,1:3]))
plot(mcmc(exp(A$post.samp[,1:3])))
log2(2/1)
log2(05/1)
log2(0.5/1)
1/(0.35^2+0.8^2)
sqrt(1/(0.35^2+0.8^2))
1/1.15
(1/(0.35+0.8))
(0.35^2+0.8^2)^(-1)
sqrt(0)
sqrt(-0)
sqrt(-0.1)
